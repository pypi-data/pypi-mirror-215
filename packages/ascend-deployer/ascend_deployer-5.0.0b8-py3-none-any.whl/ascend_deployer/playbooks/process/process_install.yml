- name: gather fact info
  import_playbook: ../gather_npu_fact.yml
  tags: always

- name: create nexus
  import_playbook: ../create_nexus.yml
  tags:
    - sys_pkg

- name: check packages for run and zip
  import_playbook: ../check_pkgs.yml
  tags:
    - atlasedge
    - docker_images
    - driver
    - firmware
    - gcc
    - ha
    - ief
    - kernels
    - mindspore
    - mindstudio
    - nnae
    - nnrt
    - npu
    - python
    - pytorch
    - sys_pkg
    - tensorflow
    - tfplguin
    - toolbox
    - toolkit

- name: copy resources to remote servers
  import_playbook: ../distribution.yml
  tags: copy

- name: install sys pkg
  import_playbook: ../install/install_sys_pkg.yml
  tags: sys_pkg

- name: install python
  import_playbook: ../install/install_python.yml
  tags: python

- name: install npu
  import_playbook: ../install/install_npu.yml
  tags: driver,firmware,npu

- name: install atlasedge
  import_playbook: ../install/install_atlasedge.yml
  tags: atlasedge

- name: install docker images
  import_playbook: ../install/install_docker_images.yml
  tags: docker_images

- name: install gcc
  import_playbook: ../install/install_gcc.yml
  tags: gcc

- name: install ha
  import_playbook: ../install/install_ha.yml
  tags: ha

- name: install ief
  import_playbook: ../install/install_ief.yml
  tags: ief

- name: install mindstudio
  import_playbook: ../install/install_mindstudio.yml
  tags: mindstudio

- name: install toolkit
  import_playbook: ../install/install_toolkit.yml
  tags: toolkit

- name: install nnrt
  import_playbook: ../install/install_nnrt.yml
  tags: nnrt

- name: install nnae
  import_playbook: ../install/install_nnae.yml
  tags: nnae

- name: install tfplugin
  import_playbook: ../install/install_tfplugin.yml
  tags: tfplugin

- name: install kernels
  import_playbook: ../install/install_kernels.yml
  tags: kernels

- name: install toolbox
  import_playbook: ../install/install_toolbox.yml
  tags: toolbox

- name: install pytorch
  import_playbook: ../install/install_pytorch.yml
  tags: pytorch

- name: install tensorflow
  import_playbook: ../install/install_tensorflow.yml
  tags: tensorflow

- name: install mindspore
  import_playbook: ../install/install_mindspore.yml
  tags: mindspore

- name: prepare for dl
  import_playbook: ../install/task_dl.yml
  tags:
    - volcano
    - hccl
    - device_plugin
    - noded
    - npu_exporter
    - docker_runtime

- name: install volcano
  import_playbook: ../install/install_volcano.yml
  tags: volcano

- name: install hccl
  import_playbook: ../install/install_hccl.yml
  tags: hccl

- name: install device plugin
  import_playbook: ../install/install_device_plugin.yml
  tags: device_plugin

- name: install noded
  import_playbook: ../install/install_noded.yml
  tags: noded

- name: install npu-exporter
  import_playbook: ../install/install_npu_exporter.yml
  tags: npu_exporter

- name: install docker-runtime
  import_playbook: ../install/install_docker_runtime.yml
  tags: docker_runtime

- name: clean nexus
  import_playbook: ../clean_nexus.yml
  tags: sys_pkg

- name: generate report
  import_playbook: ../report.yaml
  tags: always
