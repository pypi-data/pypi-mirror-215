"use strict";(self.webpackChunk_dagster_io_dagit_app=self.webpackChunk_dagster_io_dagit_app||[]).push([[399],{18399:function(e,n,t){t.r(n),t.d(n,{RunRoot:function(){return vt},default:function(){return yt}});var o,r,i,s,a,l,u,c,d,p=t(71171),g=t(90239),f=t(31623),h=t(47515),m=t(20356),v=t(83473),y=t(57103),x=t(95714),w=t(73070),j=t(67445),b=t(78193),C=t(50032),S=t(88949),L=t(74894),I=t(9938),Z=t(67099),R=t(24265),N=t(46856),T=t(92761),E=t(66708),k=t(80500),D=t(74492),K=t(68079),_=t(33028),F=t(96234),O=t(60319),P=t(17868),U=t(84464),A=t(80005),M=t(62709),q=t(92014),V=t(99641),$=t(92764),G=t(23555),J=t(46860),Q=(0,f.Ps)(o||(o=(0,p.Z)(["\n  query InstanceSupportsCapturedLogs {\n    instance {\n      id\n      hasCapturedLogManager\n    }\n  }\n"]))),W=t(59740),H=t(78912),z=t(32667),B=t(32375),Y=t(33418),X=t(23142),ee=t(9249),ne=t(87371),te=t(45754),oe=t(86906),re=t(4537),ie=t(62459),se=t(24748),ae=t.n(se),le=t(35936),ue=b.memo((function(e){var n=e.logData,t=e.location,o=e.isLoading,r=e.isVisible,i=e.downloadUrl,s=b.useRef(null),a=b.useRef(),l=b.useState(!1),u=(0,F.Z)(l,2),c=u[0],d=u[1],p=function(){a.current&&(clearTimeout(a.current),a.current=0)},g=function(){d(!1),p()},f=function(){a.current=window.setTimeout(g,3e3)},h=n,m=ce(h);if(h&&m){var v=h.indexOf("\n")+1,y=v<h.length?h.slice(v):h;h="\x1b[33m...logs truncated...\x1b[39m\n"+y}var x=m?(0,le.jsx)(Le,{children:(0,le.jsxs)(re.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,le.jsx)(B.JO,{name:"warning",color:z.w.Yellow500}),(0,le.jsxs)("div",{children:["This log has exceeded the 5MB limit."," ",i?(0,le.jsx)("a",{href:i,download:!0,children:"Download the full log file"}):null,"."]})]})}):null;return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)(ve,{isVisible:r,children:[c?(0,le.jsx)(Ce,{children:(0,le.jsx)(Se,{onClick:function(){s.current&&s.current.scrollToTop()},onMouseOver:p,onMouseOut:f,children:(0,le.jsxs)(re.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,le.jsx)(B.JO,{name:"arrow_upward",color:z.w.White}),"Scroll to top"]})})}):null,(0,le.jsxs)(xe,{children:[x,(0,le.jsx)(we,{children:(0,le.jsx)(je,{isSelected:!0,content:n,onScrollUp:function(e){p(),e?(d(!0),f()):g()},onScrollDown:g,ref:s})})]}),o?(0,le.jsx)(be,{children:(0,le.jsx)(ie.$,{purpose:"page"})}):null]}),t?(0,le.jsx)(ye,{isVisible:r,children:t}):null]})})),ce=function(e){return!!e&&(new TextEncoder).encode(e).length>=5242880},de=function(e){(0,te.Z)(t,e);var n=(0,oe.Z)(t);function t(){var e;(0,ee.Z)(this,t);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).container=b.createRef(),e.lastScroll=0,e.onScroll=function(){if(e.container.current&&e.props.isSelected){var n=e.props,t=n.onScrollUp,o=n.onScrollDown,r=e.container.current,i=r.scrollHeight,s=r.scrollTop/(i-r.offsetHeight);e.container.current.scrollTop<e.lastScroll?t&&t(s):o&&o(s),e.lastScroll=e.container.current.scrollTop}},e}return(0,ne.Z)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom(),this.container.current&&(this.container.current.focus(),this.container.current.addEventListener("scroll",this.onScroll))}},{key:"getSnapshotBeforeUpdate",value:function(){if(!this.container.current)return!1;var e=this.container.current,n=e.scrollHeight,t=e.scrollTop;return e.offsetHeight+t>=n}},{key:"componentDidUpdate",value:function(e,n,t){t&&this.scrollToBottom(),this.props.isSelected&&!e.isSelected&&this.container.current&&this.container.current.focus()}},{key:"focus",value:function(){var e=this.container.current;e&&e.focus()}},{key:"scrollToBottom",value:function(){var e=this.container.current;e&&(e.scrollTop=e.scrollHeight-e.offsetHeight)}},{key:"scrollToTop",value:function(){var e=this.container.current;e&&(e.scrollTop=0,e.focus())}},{key:"render",value:function(){var e=this.props,n=e.content,t=e.className;return n?(0,le.jsx)("div",{className:t,style:{outline:"none"},ref:this.container,tabIndex:0,children:(0,le.jsxs)(me,{children:[(0,le.jsx)(pe,{content:n}),(0,le.jsxs)(ge,{children:[(0,le.jsx)(he,{}),(0,le.jsx)(ae(),{linkify:!1,useClasses:!0,children:n})]})]})}):(0,le.jsx)("div",{className:t,ref:this.container,children:(0,le.jsx)(me,{style:{justifyContent:"center",alignItems:"center"},children:null==n?"No log file available":"No output"})})}}]),t}(b.Component),pe=function(e){var n=e.content;if(!n)return null;var t=n.match(/\n/g),o=t?t.length:0;return(0,le.jsx)(fe,{children:Array.from(Array(o),(function(e,n){return(0,le.jsx)("div",{children:String(n+1)},n)}))})},ge=O.ZP.div.withConfig({displayName:"RawLogContent__Content",componentId:"sc-175qttj-0"})(["padding:10px;background-color:",";"],z.w.Gray900),fe=O.ZP.div.withConfig({displayName:"RawLogContent__LineNumberContainer",componentId:"sc-175qttj-1"})(["display:flex;flex-direction:column;align-items:flex-end;border-right:1px solid #5c7080;padding:10px 10px 10px 20px;margin-right:5px;background-color:",";opacity:0.8;color:#858585;min-height:100%;"],z.w.Gray900),he=(0,O.vJ)(r||(r=(0,p.Z)(["\n  .ansi-black {\n    color: #586e75;\n  }\n  .ansi-red {\n    color: #dc322f;\n  }\n  .ansi-green {\n    color: #859900;\n  }\n  .ansi-yellow {\n    color: #b58900;\n  }\n  .ansi-blue {\n    color: #268bd2;\n  }\n  .ansi-magenta {\n    color: #d33682;\n  }\n  .ansi-cyan {\n    color: #2aa198;\n  }\n  .ansi-white {\n    color: #eee8d5;\n  }\n"]))),me=O.ZP.div.withConfig({displayName:"RawLogContent__ContentContainer",componentId:"sc-175qttj-2"})(["display:flex;flex-direction:row;min-height:100%;background-color:",";"],z.w.Gray900),ve=O.ZP.div.withConfig({displayName:"RawLogContent__FileContainer",componentId:"sc-175qttj-3"})(["flex:1;height:100%;position:relative;&:first-child{border-right:0.5px solid #5c7080;}display:flex;flex-direction:column;",""],(function(e){return e.isVisible?null:"display: none;"})),ye=O.ZP.div.withConfig({displayName:"RawLogContent__FileFooter",componentId:"sc-175qttj-4"})(["display:flex;flex-direction:row;align-items:center;height:30px;background-color:",";border-top:0.5px solid #5c7080;color:#aaaaaa;padding:2px 5px;font-size:0.85em;",""],z.w.Gray900,(function(e){return e.isVisible?null:"display: none;"})),xe=O.ZP.div.withConfig({displayName:"RawLogContent__FileContent",componentId:"sc-175qttj-5"})(["flex:1;display:flex;flex-direction:column;"]),we=O.ZP.div.withConfig({displayName:"RawLogContent__RelativeContainer",componentId:"sc-175qttj-6"})(["flex:1;position:relative;"]),je=(0,O.ZP)(de).withConfig({displayName:"RawLogContent__LogContent",componentId:"sc-175qttj-7"})(["color:#eeeeee;font-family:",";font-size:16px;white-space:pre;overflow:auto;position:absolute;top:0;bottom:0;left:0;right:0;"],y.b.monospace),be=O.ZP.div.withConfig({displayName:"RawLogContent__LoadingContainer",componentId:"sc-175qttj-8"})(["display:flex;justifycontent:center;alignitems:center;position:absolute;top:0;bottom:0;left:0;right:0;backgroundcolor:",";opacity:0.3;"],z.w.Gray800),Ce=O.ZP.div.withConfig({displayName:"RawLogContent__ScrollToast",componentId:"sc-175qttj-9"})(["position:absolute;height:30px;top:0;left:0;right:0;display:flex;flex-direction:row;justify-content:center;align-items:flex-start;z-index:1;"]),Se=O.ZP.div.withConfig({displayName:"RawLogContent__ScrollToTop",componentId:"sc-175qttj-10"})(["background-color:black;padding:10px 20px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;color:white;border-bottom:0.5px solid #5c7080;border-left:0.5px solid #5c7080;border-right:0.5px solid #5c7080;cursor:pointer;"]),Le=O.ZP.div.withConfig({displayName:"RawLogContent__FileWarning",componentId:"sc-175qttj-11"})(["background-color:#fffae3;padding:10px 20px;margin:20px 70px;border-radius:5px;"]),Ie=["logCaptureInfo"],Ze=b.memo((function(e){var n=e.logCaptureInfo,t=(0,W.Z)(e,Ie),o=n&&("stdout"===t.visibleIOType?n.externalStdoutUrl:n.externalStderrUrl);return o?(0,le.jsxs)(h.x,{flex:{direction:"row",alignItems:"center",justifyContent:"center",gap:1},background:z.w.Gray900,style:{color:z.w.White,flex:1,minHeight:0},children:["View logs at",(0,le.jsx)("a",{href:o,target:"_blank",rel:"noreferrer",style:{color:z.w.White,textDecoration:"underline",marginLeft:4,marginRight:4},children:o}),(0,le.jsx)(B.JO,{name:"open_in_new",color:z.w.White,size:20,style:{marginTop:2}})]}):t.logKey.length?(0,le.jsx)(Ue,(0,_.Z)({},t)):null})),Re=5242880,Ne=function(e){return e.length<Re?e:e.slice(-5242880)},Te=function(e,n){return n?Ne(e?e+n:n):e||null},Ee=function(e,n){var t,o,r;switch(n.type){case"update":return(0,_.Z)((0,_.Z)({},e),{},{isLoading:!1,cursor:null===(t=n.logData)||void 0===t?void 0:t.cursor,stdout:Te(e.stdout,null===(o=n.logData)||void 0===o?void 0:o.stdout),stderr:Te(e.stderr,null===(r=n.logData)||void 0===r?void 0:r.stderr)});case"metadata":return(0,_.Z)((0,_.Z)({},e),n.metadata);case"reset":return(0,_.Z)({},ke);default:return e}},ke={stdout:null,stderr:null,cursor:null,isLoading:!0},De=b.memo((function(e){var n=e.logKey,t=e.onLogData;return(0,H.m)(Ke,{fetchPolicy:"no-cache",variables:{logKey:n},onSubscriptionData:function(e){var n,o=e.subscriptionData;null!==(n=o.data)&&void 0!==n&&n.capturedLogs&&t(o.data.capturedLogs)}}),null})),Ke=(0,f.Ps)(i||(i=(0,p.Z)(["\n  subscription CapturedLogsSubscription($logKey: [String!]!, $cursor: String) {\n    capturedLogs(logKey: $logKey, cursor: $cursor) {\n      ...CapturedLog\n    }\n  }\n\n  fragment CapturedLog on CapturedLogs {\n    stdout\n    stderr\n    cursor\n  }\n"]))),_e=(0,f.Ps)(s||(s=(0,p.Z)(["\n  query CapturedLogsMetadataQuery($logKey: [String!]!) {\n    capturedLogsMetadata(logKey: $logKey) {\n      stdoutDownloadUrl\n      stdoutLocation\n      stderrDownloadUrl\n      stderrLocation\n    }\n  }\n"]))),Fe=function(e){var n=e.logKey,t=e.children,o=b.useReducer(Ee,ke),r=(0,F.Z)(o,2),i=r[0],s=r[1],a=JSON.stringify(n);b.useEffect((function(){s({type:"reset"})}),[a]);var l=b.useCallback((function(e){s({type:"update",logData:e})}),[]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(De,{logKey:n,onLogData:l}),t(i)]})},Oe=function(e){var n=e.logKey,t=e.children,o=b.useReducer(Ee,ke),r=(0,F.Z)(o,2),i=r[0],s=r[1],a=JSON.stringify(n);b.useEffect((function(){s({type:"reset"})}),[a]);var l=i.cursor,u=(0,g.a)(Pe,{notifyOnNetworkStatusChange:!0,variables:{logKey:n,cursor:l,limit:1e5},pollInterval:5e3,onCompleted:function(e){c(),s({type:"update",logData:e.capturedLogs}),d(5e3)}}),c=u.stopPolling,d=u.startPolling;return(0,le.jsx)(le.Fragment,{children:t(i)})},Pe=(0,f.Ps)(a||(a=(0,p.Z)(["\n  query CapturedLogsQuery($logKey: [String!]!, $cursor: String, $limit: Int) {\n    capturedLogs(logKey: $logKey, cursor: $cursor, limit: $limit) {\n      stdout\n      stderr\n      cursor\n    }\n  }\n"]))),Ue=b.memo((function(e){var n,t,o=e.logKey,r=e.visibleIOType,i=e.onSetDownloadUrl,s=b.useContext(Y.I).rootServerURI,a=b.useContext(X.DN),l=a.availability,u=a.disabled,c=(0,g.a)(_e,{variables:{logKey:o}});b.useEffect((function(){if(i&&c.data){var e="stdout"===r?c.data.capturedLogsMetadata.stdoutDownloadUrl:c.data.capturedLogsMetadata.stderrDownloadUrl;e&&(e.startsWith("/")?i(s+e):i(e))}}),[i,r,s,c.data]);var d=(null===(n=c.data)||void 0===n?void 0:n.capturedLogsMetadata.stdoutLocation)||void 0,p=(null===(t=c.data)||void 0===t?void 0:t.capturedLogsMetadata.stderrLocation)||void 0,f="unavailable"===l||u?Oe:Fe;return(0,le.jsx)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:(0,le.jsx)(f,{logKey:o,children:function(e){return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ue,{logData:e.stdout,isLoading:e.isLoading,location:d,isVisible:"stdout"===r}),(0,le.jsx)(ue,{logData:e.stderr,isLoading:e.isLoading,location:p,isVisible:"stderr"===r})]})}})})})),Ae=5242880,Me=function(e){return e.length<Ae?e:e.slice(-5242880)},qe=function(e,n){if(!n)return e;var t=null===e||void 0===e?void 0:e.data;return null!==e&&void 0!==e&&e.data&&null!==n&&void 0!==n&&n.data?t=Me(e.data+n.data):null!==n&&void 0!==n&&n.data&&(t=Me(n.data)),{__typename:n.__typename,path:n.path,downloadUrl:n.downloadUrl,data:"string"===typeof t?t:null,cursor:n.cursor}},Ve=function(e,n){switch(n.type){case"stdout":var t=n.stepKey===e.stepKey?qe(e.stdout,n.log):n.log;return(0,_.Z)((0,_.Z)({},e),{},{isLoading:!1,stdout:t});case"stderr":var o=n.stepKey===e.stepKey?qe(e.stderr,n.log):n.log;return(0,_.Z)((0,_.Z)({},e),{},{isLoading:!1,stderr:o});default:return e}},$e={stepKey:"",stdout:null,stderr:null,isLoading:!0},Ge=(0,f.Ps)(l||(l=(0,p.Z)(["\n  subscription ComputeLogsSubscription(\n    $runId: ID!\n    $stepKey: String!\n    $ioType: ComputeIOType!\n    $cursor: String\n  ) {\n    computeLogs(runId: $runId, stepKey: $stepKey, ioType: $ioType, cursor: $cursor) {\n      ...ComputeLogForSubscription\n    }\n  }\n\n  fragment ComputeLogForSubscription on ComputeLogFile {\n    path\n    cursor\n    data\n    downloadUrl\n  }\n"]))),Je=function(e){var n=e.runId,t=e.stepKeys,o=e.computeLogFileKey,r=e.ioType,i=e.setComputeLogUrl;return t.length&&o?(0,le.jsx)(We,{runId:n,computeLogFileKey:o,ioType:r,setComputeLogUrl:i}):(0,le.jsx)(h.x,{flex:{justifyContent:"center",alignItems:"center"},style:{flex:1,height:"100%"},children:(0,le.jsx)(ie.$,{purpose:"section"})})},Qe=function(e,n){if(!n)return null;var t;return(t=n)&&t.startsWith("/")?e+n:n},We=b.memo((function(e){var n=e.runId,t=e.computeLogFileKey,o=e.ioType,r=e.setComputeLogUrl,i=b.useContext(Y.I).rootServerURI,s=function(e,n){var t=b.useReducer(Ve,$e),o=(0,F.Z)(t,2),r=o[0],i=o[1];return(0,H.m)(Ge,{fetchPolicy:"no-cache",variables:{runId:e,stepKey:n,ioType:G.E90.STDOUT,cursor:null},onSubscriptionData:function(e){var t,o=e.subscriptionData;i({type:"stdout",stepKey:n,log:(null===(t=o.data)||void 0===t?void 0:t.computeLogs)||null})}}),(0,H.m)(Ge,{fetchPolicy:"no-cache",variables:{runId:e,stepKey:n,ioType:G.E90.STDERR,cursor:null},onSubscriptionData:function(e){var t,o=e.subscriptionData;i({type:"stderr",stepKey:n,log:(null===(t=o.data)||void 0===t?void 0:t.computeLogs)||null})}}),r}(n,t),a=s.isLoading,l=s.stdout,u=s.stderr,c=Qe(i,(null===l||void 0===l?void 0:l.downloadUrl)||null),d=Qe(i,(null===u||void 0===u?void 0:u.downloadUrl)||null);return(0,le.jsxs)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[(0,le.jsx)(He,{content:l?l.data:null,path:l?l.path:void 0,downloadUrl:c,isLoading:a,isVisible:"stdout"===o,setComputeLogUrl:r}),(0,le.jsx)(He,{content:u?u.data:null,path:u?u.path:void 0,downloadUrl:d,isLoading:a,isVisible:"stderr"===o,setComputeLogUrl:r})]})})),He=function(e){var n=e.isLoading,t=e.isVisible,o=e.content,r=e.path,i=e.downloadUrl,s=e.setComputeLogUrl;return b.useEffect((function(){s(i)}),[s,i]),(0,le.jsx)(ue,{logData:o,isLoading:n,isVisible:t,downloadUrl:i,location:r})},ze=t(41361),Be=t(61794),Ye=t(47317),Xe=t.n(Ye),en=t(42236),nn=t(75302),tn={DEBUG:0,INFO:0,WARNING:0,ERROR:0,CRITICAL:0,EVENT:0},on=function(e,n){switch(n.type){case"append":var t=n.queued.map((function(e,n){return(0,_.Z)((0,_.Z)({},e),{},{clientsideKey:"csk".concat(e.timestamp,"-").concat(n)})})),o=[].concat((0,K.Z)(e.nodes),(0,K.Z)(t)),r=(0,_.Z)({},e.counts);return t.forEach((function(e){var n=(0,nn.m)(e);r[n]++})),{nodes:o,counts:r,loading:n.hasMore,cursor:n.cursor};case"set-cursor":return(0,_.Z)((0,_.Z)({},e),{},{cursor:n.cursor});case"reset":return{nodes:[],counts:tn,cursor:null,loading:!0};default:return e}},rn={nodes:[],counts:tn,cursor:null,loading:!0},sn=function(e){var n=(0,Be.x)(),t=b.useRef([]),o=b.useReducer(on,rn),r=(0,F.Z)(o,2),i=r[0],s=r[1],a=b.useCallback((function(t){var o=n.readFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:pn,id:"Run:".concat(e)});if(o){var r=(0,_.Z)((0,_.Z)({},o),{},{canTerminate:t===G.VOA.QUEUED||t===G.VOA.STARTED,status:t});n.writeFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:pn,id:"Run:".concat(e),data:r})}}),[n,e]);b.useEffect((function(){t.current=[],s({type:"reset"})}),[e]);var l=b.useMemo((function(){return Xe()((function(){if(t.current.length){var e=(0,K.Z)(t.current);t.current=[];var n=e.flatMap((function(e){return e.messages})),o=e[e.length-1],r=o.hasMorePastEvents,i=o.cursor;s({type:"append",queued:n,hasMore:r,cursor:i});var l=function(e){var n,t=(0,K.Z)(e).reverse(),o=(0,ze.Z)(t);try{for(o.s();!(n=o.n()).done;)switch(n.value.__typename){case"RunStartEvent":return G.VOA.STARTED;case"RunEnqueuedEvent":return G.VOA.QUEUED;case"RunStartingEvent":return G.VOA.STARTING;case"RunCancelingEvent":return G.VOA.CANCELING;case"RunCanceledEvent":return G.VOA.CANCELED;case"RunSuccessEvent":return G.VOA.SUCCESS;case"RunFailureEvent":return G.VOA.FAILURE}}catch(r){o.e(r)}finally{o.f()}return null}(n);l&&!r&&a(l)}}),100)}),[a]),u=i.nodes,c=i.counts,d=i.cursor,p=i.loading,g=b.useContext(X.DN),f=g.availability,h=g.disabled,m=g.status,v=!h&&"available"===f&&m===WebSocket.CLOSED,y=b.useRef(d);v&&(y.current=d);var x=y.current,w=b.useMemo((function(){return{runId:e,cursor:x}}),[e,x]),j=b.useMemo((function(){return(0,le.jsx)(an,{variables:w,onSubscriptionData:function(e){var n,o=null===(n=e.subscriptionData.data)||void 0===n?void 0:n.pipelineRunLogs;o&&"PipelineRunLogsSubscriptionFailure"!==o.__typename&&(t.current.push(o),requestAnimationFrame(l))}})}),[w,l]);return b.useMemo((function(){return null!==u?{allNodes:u,counts:c,loading:p,subscriptionComponent:j}:{allNodes:[],counts:c,loading:p,subscriptionComponent:j}}),[c,p,u,j])},an=function(e){var n=e.variables,t=e.onSubscriptionData;return(0,H.m)(dn,{fetchPolicy:"no-cache",variables:n,onSubscriptionData:t}),null},ln=function(e){var n=sn(e.runId);return(0,le.jsxs)(le.Fragment,{children:[n.subscriptionComponent,e.children(n)]})},un=function(e){var n=e.children,t=e.runId,o=b.useReducer(on,rn),r=(0,F.Z)(o,2),i=r[0],s=r[1],a=i.counts,l=i.cursor,u=i.nodes,c=(0,g.a)(gn,{notifyOnNetworkStatusChange:!0,variables:{runId:t,cursor:l,limit:1e4},pollInterval:5e3,onCompleted:function(e){if(d(),"Run"===(null===e||void 0===e?void 0:e.pipelineRunOrError.__typename)&&"EventConnection"===(null===e||void 0===e?void 0:e.logsForRun.__typename)){var n=e.pipelineRunOrError,t=e.logsForRun.events,o=n.status,r=e.logsForRun.cursor,i=!!o&&o!==G.VOA.FAILURE&&o!==G.VOA.SUCCESS&&o!==G.VOA.CANCELED;s({type:"append",queued:t,hasMore:i,cursor:r}),i&&p(5e3)}}}),d=c.stopPolling,p=c.startPolling;return(0,le.jsx)(le.Fragment,{children:n(null!==u&&u.length>0?{allNodes:u,counts:a,loading:!1}:{allNodes:[],counts:a,loading:!0})})},cn=function(e){var n=e.children,t=e.runId,o=b.useContext(X.DN),r=o.availability,i=o.disabled;return"unavailable"===r||i?(0,le.jsx)(un,{runId:t,children:n}):"attempting-to-connect"===r?(0,le.jsx)(le.Fragment,{children:n({allNodes:[],counts:tn,loading:!0})}):(0,le.jsx)(ln,{runId:t,children:n})},dn=(0,f.Ps)(u||(u=(0,p.Z)(["\n  subscription PipelineRunLogsSubscription($runId: ID!, $cursor: String) {\n    pipelineRunLogs(runId: $runId, cursor: $cursor) {\n      ... on PipelineRunLogsSubscriptionFailure {\n        missingRunId\n        message\n      }\n      ...RunLogsSubscriptionSuccess\n    }\n  }\n\n  fragment RunLogsSubscriptionSuccess on PipelineRunLogsSubscriptionSuccess {\n    messages {\n      ... on MessageEvent {\n        runId\n      }\n      ...RunDagsterRunEventFragment\n    }\n    hasMorePastEvents\n    cursor\n  }\n\n  ","\n"])),en.$K),pn=(0,f.Ps)(c||(c=(0,p.Z)(["\n  fragment PipelineRunLogsSubscriptionStatusFragment on Run {\n    id\n    status\n    canTerminate\n  }\n"]))),gn=(0,f.Ps)(d||(d=(0,p.Z)(["\n  query RunLogsQuery($runId: ID!, $cursor: String, $limit: Int) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        canTerminate\n      }\n    }\n    logsForRun(runId: $runId, afterCursor: $cursor, limit: $limit) {\n      ... on EventConnection {\n        events {\n          ... on MessageEvent {\n            runId\n          }\n          ...RunDagsterRunEventFragment\n        }\n        cursor\n      }\n      ... on PythonError {\n        message\n        stack\n      }\n    }\n  }\n\n  ","\n"])),en.$K),fn=t(20317),hn=t(56666),mn=t(21189),vn=t(33290),yn=t(85357),xn=t(45519),wn=t(16185),jn=t(44229),bn=t(17914),Cn=t(22260),Sn=t(50319),Ln=t(79962),In=t(90986),Zn=O.ZP.div.withConfig({displayName:"ExecutionStateDot",componentId:"sc-1e4maq3-0"})(["display:inline-block;width:11px;height:11px;border-radius:5.5px;transition:background 200ms linear;background:",";&:hover{background:",";}"],(function(e){var n,t=e.state;return(n={},(0,hn.Z)(n,In.TN.RUNNING,z.w.Gray400),(0,hn.Z)(n,In.TN.SUCCEEDED,z.w.Green700),(0,hn.Z)(n,In.TN.SKIPPED,z.w.Yellow500),(0,hn.Z)(n,In.TN.FAILED,z.w.Red500),(0,hn.Z)(n,In.TN.PREPARING,z.w.Red500),(0,hn.Z)(n,In.TN.RETRY_REQUESTED,z.w.Red500),(0,hn.Z)(n,In.TN.UNKNOWN,z.w.Red500),n)[t]}),(function(e){var n,t=e.state;return(n={},(0,hn.Z)(n,In.TN.RUNNING,z.w.Gray400),(0,hn.Z)(n,In.TN.SUCCEEDED,z.w.Green700),(0,hn.Z)(n,In.TN.SKIPPED,z.w.Yellow500),(0,hn.Z)(n,In.TN.FAILED,z.w.Red200),(0,hn.Z)(n,In.TN.PREPARING,z.w.Red500),(0,hn.Z)(n,In.TN.RETRY_REQUESTED,z.w.Red500),(0,hn.Z)(n,In.TN.UNKNOWN,z.w.Red500),n)[t]})),Rn=t(25960),Nn=function(e){var n=e.options,t=e.onSetFilter,o=b.useState(!1),r=(0,F.Z)(o,2),i=r[0],s=r[1],a=Object.keys(n),l=Object.values(n).reduce((function(e,n){return n.enabled?e+1:e}),0),u=function(e){return function(n){var o=n.target.checked;t(e,o)}};return(0,le.jsx)(w.J,{isOpen:i,placement:"bottom-start",canEscapeKeyClose:!0,onInteraction:function(e){return s(e)},content:(0,le.jsx)(yn.v2,{style:{width:"180px"},"aria-label":"filter-options",children:a.map((function(e){var t=n[e],o=t.label,r=t.count,i=t.enabled;return(0,le.jsx)(yn.sN,{tagName:"div",shouldDismissPopover:!1,text:(0,le.jsx)(h.x,{flex:{direction:"row",alignItems:"center"},children:(0,le.jsx)(En,{id:"menu-check-".concat(e),checked:i,onChange:u(e),label:(0,le.jsxs)(h.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"center"},style:{flex:1},children:[(0,le.jsx)("div",{children:o}),(0,le.jsx)("div",{style:{color:z.w.Gray500},children:(0,Rn.J)(r)})]})})})},e)}))}),children:(0,le.jsxs)(Tn,{onClick:function(){return s((function(e){return!e}))},icon:(0,le.jsx)(B.JO,{name:"filter_alt"}),rightIcon:(0,le.jsx)(B.JO,{name:"expand_more"}),children:["Levels (",l,")"]})})},Tn=(0,O.ZP)(xn.zx).withConfig({displayName:"LogFilterSelect__FilterButton",componentId:"sc-fb8dp1-0"})(["justify-content:space-between;width:100%;"]),En=(0,O.ZP)(bn.X).withConfig({displayName:"LogFilterSelect__MenuCheckbox",componentId:"sc-fb8dp1-1"})(["display:flex;flex:1;"]),kn=t(15998),Dn=t(80923),Kn=t(53984),_n=t(79936),Fn=function(e,n){switch(n.type){case"show-popover":return(0,_.Z)((0,_.Z)({},e),{},{shown:!0});case"hide-popover":return(0,_.Z)((0,_.Z)({},e),{},{shown:!1});case"highlight":return(0,_.Z)((0,_.Z)({},e),{},{highlight:n.highlight});case"change-query":return(0,_.Z)((0,_.Z)({},e),{},{shown:!0,highlight:0});case"select-suggestion":return(0,_.Z)((0,_.Z)({},e),{},{highlight:0});default:return e}},On={shown:!1,highlight:0},Pn={threshold:.3},Un=function(e){var n=e.value,t=e.onChange,o=e.suggestionProviders,r=b.useReducer(Fn,On),i=(0,F.Z)(r,2),s=i[0],a=i[1],l=s.shown,u=s.highlight,c=b.useRef(null),d=b.useMemo((function(){var e=o.reduce((function(e,n){var t=n.values();return n.token?(0,_.Z)((0,_.Z)({},e),{},(0,hn.Z)({},n.token,{fuse:new Kn.Z(t,Pn),all:t})):e}),{}),n=o.map((function(e){return e.token})).filter((function(e){return e}));return{empty:new Kn.Z(n,Pn),perProvider:e}}),[o]),p=d.empty,g=d.perProvider,f=b.useCallback((function(e){if(!e)return Object.keys(g);var n=e.split(":"),t=(0,F.Z)(n,2),o=t[0],r=t[1];if(o&&o in g){var i=g[o],s=i.fuse,a=i.all,l=r?s.search(r).map((function(e){return"".concat(o,":").concat(e.item)})):a.map((function(e){return"".concat(o,":").concat(e)}));return l.map((function(e){return e.toLowerCase()})).includes(e)?[]:l}return p.search(e).map((function(e){return e.item}))}),[p,g]),h=function(e,n){var t=n.toLocaleLowerCase().trim().split(/\s+/),o=t[t.length-1]||"",r=b.useMemo((function(){return e(o)}),[e,o]),i=b.useCallback((function(e){var t=n.toLocaleLowerCase().lastIndexOf(o);if(-1!==t){var r=n.slice(0,t);return"".concat(r).concat(e)}return n}),[o,n]);return b.useMemo((function(){return{suggestions:r,onSelectSuggestion:i}}),[i,r])}(f,n),m=h.suggestions,v=h.onSelectSuggestion,y=m.length,x=m[u]||null,j=b.useCallback((function(e){a({type:"change-query"}),t(e.target.value)}),[t]),C=b.useCallback((function(e){a({type:"select-suggestion"}),t(v(e))}),[t,v]),S=b.useCallback((function(){var e;a({type:"change-query"}),t(""),null===(e=c.current)||void 0===e||e.focus()}),[t]);return(0,le.jsx)(w.J,{isOpen:l&&m.length>0,position:"bottom-left",content:(0,le.jsx)(qn,{children:m.map((function(e,n){return(0,le.jsx)(An,{suggestion:e,isHighlight:u===n,onSelect:C},e)}))}),children:(0,le.jsx)(Mn,{placeholder:"Filter\u2026",spellCheck:!1,autoCorrect:"off",value:n,ref:c,onChange:j,onFocus:function(){return a({type:"show-popover"})},onBlur:function(){return a({type:"hide-popover"})},onKeyDown:function(e){var n=e.key;if("Escape"!==n){if(y){var t=y-1;switch(n){case"ArrowUp":e.preventDefault(),a({type:"highlight",highlight:0===u?t:u-1});break;case"ArrowDown":e.preventDefault(),a({type:"highlight",highlight:u===t?0:u+1});break;case"Enter":e.preventDefault(),x&&C(x)}}}else a({type:"hide-popover"})},rightElement:(0,le.jsx)(_n.C,{onClick:S,children:(0,le.jsx)(B.JO,{name:"cancel"})})})})},An=function(e){var n=e.suggestion,t=e.isHighlight,o=e.onSelect,r=b.useRef(null);return b.useEffect((function(){r.current&&t&&r.current.scrollIntoView({block:"nearest"})}),[t]),(0,le.jsx)(Vn,{ref:r,isHighlight:t,onMouseDown:function(e){e.preventDefault(),o(n)},children:n})},Mn=(0,O.ZP)(Dn.oi).withConfig({displayName:"LogsFilterInput__FilterInput",componentId:"sc-3dxor8-0"})(["width:300px;"]),qn=O.ZP.ul.withConfig({displayName:"LogsFilterInput__Results",componentId:"sc-3dxor8-1"})(["list-style:none;margin:0;max-height:200px;max-width:800px;min-width:300px;overflow-y:auto;padding:4px 0;"]),Vn=O.ZP.li.withConfig({displayName:"LogsFilterInput__Item",componentId:"sc-3dxor8-2"})(["align-items:center;background-color:",";color:",";cursor:pointer;display:flex;flex-direction:row;font-size:12px;list-style:none;margin:0;padding:4px 8px;white-space:nowrap;text-overflow:ellipsis;&:hover{background-color:",";}"],(function(e){return e.isHighlight?z.w.Blue500:z.w.White}),(function(e){return e.isHighlight?z.w.White:"default"}),(function(e){return e.isHighlight?z.w.Blue500:z.w.Gray100})),$n=t(13887),Gn=t(29845),Jn="|";function Qn(e){return e.sort().map((function(e){return e.toLowerCase()})).join(Jn)}var Wn={steps:"*",logs:"",levels:Qn(kn.w),hideNonMatches:"true",focusedTime:""},Hn=function(e){var n=e.logs||"",t=e.focusedTime||"",o=e.hideNonMatches||"",r=e.levels||"",i=n.split(Jn),s=t&&!n?Number(t):null,a="true"===o,l=(0,$n.m)();return{sinceTime:0,focusedTime:s,hideNonMatches:a,logQuery:i.map((function(e){return(0,Gn.WD)(e,l)})),levels:r.split(Jn).map((function(e){return e.toUpperCase()})).filter((function(e){return kn.i.hasOwnProperty(e)})).reduce((function(e,n){return(0,_.Z)((0,_.Z)({},e),{},(0,hn.Z)({},n,!0))}),{})}};function zn(e){var n=e.logQuery.map((function(e){return e.token?"".concat(e.token,":").concat(e.value):e.value}));return{hideNonMatches:e.hideNonMatches?"true":"false",focusedTime:e.focusedTime||"",logs:n.join(Jn),levels:Qn(Object.keys(e.levels).filter((function(n){return!!e.levels[n]})))}}var Bn="EnabledRunLogLevels",Yn=function(e){if(void 0===e||!Array.isArray(e))return null;var n=new Set(Object.keys(kn.i));return e.filter((function(e){return n.has(e)}))};var Xn,et=function(e){return e.structured="structured",e.stdout="stdout",e.stderr="stderr",e}({}),nt=function(e){var n=e.steps,t=e.metadata,o=e.counts,r=e.filter,i=e.onSetFilter,s=e.logType,a=e.onSetLogType,l=e.computeLogFileKey,u=e.onSetComputeLogKey,c=e.computeLogUrl,d=(0,Ln.U)("initial-compute-log-type",(function(e){return"string"===typeof e?e:et.stdout})),p=(0,F.Z)(d,2),g=p[0],f=p[1],m=b.useMemo((function(){return new Set([s===et.structured?s:et.stdout])}),[s]),v=b.useCallback((function(e){f(e),a(e)}),[a,f]);return(0,le.jsxs)(Sn.qn,{children:[(0,le.jsx)(h.x,{margin:{right:12},children:(0,le.jsx)(mn.h,{activeItems:m,buttons:[{id:et.structured,icon:"list",tooltip:"Structured event logs"},{id:g,icon:"wysiwyg",tooltip:"Raw compute logs"}],onClick:function(e){return a(e)}})}),"structured"===s?(0,le.jsx)(it,{counts:o,filter:r,onSetFilter:i,steps:n}):(0,le.jsx)(ot,{steps:n,metadata:t,logType:s,onSetLogType:v,computeLogFileKey:l,onSetComputeLogKey:u,computeLogUrl:c})]})},tt=function(e,n){return n.stepKeys.some((function(n){return e.steps[n].state===In.TN.RUNNING}))?In.TN.RUNNING:n.stepKeys.some((function(n){return e.steps[n].state===In.TN.SKIPPED}))?In.TN.SKIPPED:n.stepKeys.every((function(n){return e.steps[n].state===In.TN.SUCCEEDED}))?In.TN.SUCCEEDED:In.TN.FAILED},ot=function(e){var n,t,o=e.steps,r=e.metadata,i=e.computeLogFileKey,s=e.onSetComputeLogKey,a=e.logType,l=e.onSetLogType,u=e.computeLogUrl,c=r.logCaptureSteps||(0,In.co)(Object.keys(r.steps)),d=i&&c[i],p=function(e){if(!e||!c[e])return null;var n=c[e];return 1===n.stepKeys.length&&e===n.stepKeys[0]?e:n.pid&&1===n.stepKeys.length?n.stepKeys[0]:n.pid?"pid: ".concat(n.pid," (").concat(n.stepKeys.length," steps)"):"".concat(e," (").concat(n.stepKeys.length," steps)")};return(0,le.jsxs)(h.x,{flex:{justifyContent:"space-between",alignItems:"center",direction:"row"},style:{flex:1},children:[(0,le.jsxs)(re.Z,{direction:"row",spacing:24,alignItems:"center",children:[(0,le.jsx)(vn.P,{disabled:!o.length,items:Object.keys(c),itemPredicate:function(e,n){return n.toLocaleLowerCase().includes(e.toLocaleLowerCase())},itemRenderer:function(e,n){return(0,le.jsx)(yn.sN,{onClick:n.handleClick,text:p(e),active:n.modifiers.active},e)},activeItem:i,onItemSelect:function(e){s(e)},children:(0,le.jsx)(xn.zx,{disabled:!o.length,rightIcon:(0,le.jsx)(B.JO,{name:"expand_more"}),children:p(i)||"Select a step..."})}),d?(0,le.jsxs)(wn.mQ,{selectedTabId:a,onChange:l,size:"small",children:[(0,le.jsx)(wn.OK,{id:et.stdout,title:"stdout"}),(0,le.jsx)(wn.OK,{id:et.stderr,title:"stderr"})]}):null]}),d?(0,le.jsxs)(h.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[i&&c[i]?tt(r,c[i])===In.TN.RUNNING?(0,le.jsx)(ie.$,{purpose:"body-text"}):(0,le.jsx)(Zn,{state:tt(r,c[i])}):null,u?(0,le.jsx)(jn.u,{placement:"top-end",content:i&&1===(null===(n=c[i])||void 0===n?void 0:n.stepKeys.length)?"Download ".concat(null===(t=c[i])||void 0===t?void 0:t.stepKeys[0]," compute logs"):"Download compute logs",children:(0,le.jsx)(rt,{"aria-label":"Download link",href:u,download:!0,children:(0,le.jsx)(B.JO,{name:"download_for_offline",color:z.w.Gray600})})}):null]}):null]})},rt=O.ZP.a.withConfig({displayName:"LogsToolbar__DownloadLink",componentId:"sc-d9cqde-0"})(["border-radius:4px;display:block;text-decoration:none;","{transition:background-color 100ms linear;}:hover ","{background-color:",";}:active ",",:focus ","{background-color:",";}:focus{outline:none;}"],B.a1,B.a1,z.w.Gray800,B.a1,B.a1,z.w.Dark),it=function(e){var n,t=e.filter,o=e.counts,r=e.onSetFilter,i=e.steps,s=b.useState("assignment"),a=(0,F.Z)(s,2),l=a[0],u=a[1],c=t.logQuery.map((function(e){var n=e.token,t=e.value;return n?"".concat(n,":").concat(t):t})).join(" "),d=b.useState((function(){return c})),p=(0,F.Z)(d,2),g=p[0],f=p[1],m=(0,Cn.m)(),v=(0,Ln.U)(Bn,Yn),y=(0,F.Z)(v,2),x=(y[0],y[1]),w=(null===(n=t.logQuery.find((function(e){return"step"===e.token})))||void 0===n?void 0:n.value)||null,j=t.logQuery.reduce((function(e,n){return e+n.value}),"");b.useEffect((function(){f(c)}),[c]);var C=b.useCallback((function(e,n){var o=new Set(Object.keys(t.levels).filter((function(e){return!!t.levels[e]})));n?o.add(e):o.delete(e),x(Array.from(o)),r((0,_.Z)((0,_.Z)({},t),{},{levels:(0,_.Z)((0,_.Z)({},t.levels),{},(0,hn.Z)({},e,n))}))}),[t,r,x]);b.useEffect((function(){var e;return"assignment_turned_in"===l&&(e=setTimeout((function(){u("assignment")}),2e3)),function(){e&&clearTimeout(e)}}),[l]);var S=Object.fromEntries(Object.keys(kn.i).map((function(e){return[e,{label:e.toLowerCase(),count:o[e],enabled:!!t.levels[e]}]})));return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Un,{value:g,suggestionProviders:(0,$n.m)(i),onChange:function(e){var n=e.split(/\s+/).map((function(e){var n=e.split(":");return n.length>1?{token:n[0],value:n[1]}:{value:n[0]}}));r((0,_.Z)((0,_.Z)({},t),{},{logQuery:n})),f(e)}}),j?(0,le.jsx)(st,{checked:t.hideNonMatches,onChange:function(e){return r((0,_.Z)((0,_.Z)({},t),{},{hideNonMatches:e.currentTarget.checked}))},label:"Hide non-matches"}):null,(0,le.jsx)(h.x,{flex:{direction:"row",alignItems:"center",gap:8},margin:{left:12},children:(0,le.jsx)(Nn,{options:S,onSetFilter:C})}),w&&(0,le.jsx)(Sn.KC,{}),(0,le.jsx)("div",{style:{minWidth:15,flex:1}}),(0,le.jsx)(xn.zx,{icon:(0,le.jsx)(B.JO,{name:l}),onClick:function(){m(window.location.href),u("assignment_turned_in")},children:"Copy URL"})]})},st=(0,O.ZP)(bn.X).withConfig({displayName:"LogsToolbar__NonMatchCheckbox",componentId:"sc-d9cqde-1"})(["&&&{margin:0 4px 0 12px;}white-space:nowrap;"]),at=t(86252),lt=t(70037),ut=t(75731),ct=function(e){var n,t=e.run,o=e.runId,r=function(){var e=(0,Ln.U)(Bn,Yn),n=(0,F.Z)(e,1)[0],t=b.useMemo((function(){var e=null!==n&&void 0!==n?n:kn.w;return(0,_.Z)((0,_.Z)({},Wn),{},{levels:Qn(e)})}),[n]);return(0,J.q)({encode:zn,decode:Hn,defaults:t})}(),i=(0,F.Z)(r,2),s=i[0],a=i[1],l=(0,J.q)({queryKey:"selection",defaults:{selection:""}}),u=(0,F.Z)(l,2),c=u[0],d=u[1];n=t?function(e){switch(e){case G.VOA.CANCELED:case G.VOA.CANCELING:case G.VOA.FAILURE:return"/favicon-run-failed.svg";case G.VOA.SUCCESS:return"/favicon-run-success.svg";default:return"/favicon-run-pending.svg"}}(t.status):"/favicon.svg",b.useEffect((function(){var e=document.querySelector('link[rel="icon"][type="image/svg+xml"]');if(e){var t=e.getAttribute("href");return e.setAttribute("href",n),function(){t&&e.setAttribute("href",t)}}}),[n]),(0,Z.j)(t?"".concat((0,I.pv)(t.pipelineName)?"":t.pipelineName," ").concat(o.slice(0,8)," [").concat(t.status,"]"):"Run: ".concat(o));var p=function(e,n){var t=n.find((function(n){return"ExecutionStepFailureEvent"===n.__typename&&n.stepKey===e}));t&&(0,A._)({body:(0,le.jsx)(q.T9,{error:t})})},g=function(e){d(e),a((0,_.Z)((0,_.Z)({},s),{},{logQuery:"*"!==e?[{token:"query",value:e}]:[]}))};return(0,le.jsx)(lt.A.Provider,{value:t,children:(0,le.jsx)(cn,{runId:o,children:function(e){return(0,le.jsx)(In.jp,{logs:e,children:function(n){return(0,le.jsx)(pt,{run:t,runId:o,logs:e,logsFilter:s,metadata:n,selectionQuery:c,onSetLogsFilter:a,onSetSelectionQuery:g,onShowStateDetails:p})}})}},o)})},dt=function(e,n){var t=(e?Object.values(e):[]).find((function(e){return e.stepKeys.includes(n)}));return t&&(null===t||void 0===t?void 0:t.fileKey)},pt=function(e){var n=e.run,t=e.runId,o=e.logs,r=e.logsFilter,i=e.metadata,s=e.selectionQuery,a=e.onSetLogsFilter,l=e.onSetSelectionQuery,u=(0,ut.W)(n),c=b.createRef(),d=function(){var e=(0,g.a)(Q).data;return!(null===e||void 0===e||!e.instance.hasCapturedLogManager)}(),p=(0,J.q)({queryKey:"logType",defaults:{logType:"structured"}}),f=(0,F.Z)(p,2),m=f[0],v=f[1],y=(0,J.q)({queryKey:"logFileKey"}),x=(0,F.Z)(y,2),w=x[0],C=x[1],S=function(e){switch(e){case"stdout":return et.stdout;case"stderr":return et.stderr;default:return et.structured}}(m),L=b.useState(null),I=(0,F.Z)(L,2),Z=I[0],R=I[1],N=JSON.stringify(Object.keys(i.steps).sort()),T=b.useMemo((function(){return JSON.parse(N)}),[N]),E=(null===n||void 0===n?void 0:n.executionPlan)&&(0,$.J)(null===n||void 0===n?void 0:n.executionPlan,i.steps),k=b.useMemo((function(){return E&&s&&"*"!==s?(0,M.V)(E,s).all.map((function(e){return e.name})):[]}),[E,s]);b.useEffect((function(){if(null!==T&&void 0!==T&&T.length&&!w)if(i.logCaptureSteps){var e=Object.keys(i.logCaptureSteps),n=e.find((function(e){return k.every((function(n){return i.logCaptureSteps&&i.logCaptureSteps[e].stepKeys.includes(n)}))}));C(n||e[0])}else if(T.includes(w)){if(1===k.length&&w!==k[0]){var t=dt(i.logCaptureSteps,k[0]);t&&C(t)}}else{var o=dt(i.logCaptureSteps,1===k.length?k[0]:T[0]);o&&C(o)}}),[T,w,k,i.logCaptureSteps,C]);var D=E?r.logQuery.filter((function(e){return e.token&&"query"===e.token})).reduce((function(e,n){return[].concat((0,K.Z)(e),(0,K.Z)((0,M.V)(E,n.value).all.map((function(e){return e.name}))))}),[]):[],_=function(e,n){var t,o=k.indexOf(e),r='"'.concat(e,'"');if(n.shiftKey)t=(0,K.Z)(k.map((function(e){return s.includes('"'.concat(e,'"'))?'"'.concat(e,'"'):e}))),-1!==o?t.splice(o,1):t.push(r);else if(1===k.length&&-1!==o)t=[];else{t=[r];var a=dt(i.logCaptureSteps,e);a&&C(a)}l(t.join(", ")||"*")},O=i.logCaptureSteps&&w in i.logCaptureSteps?i.logCaptureSteps[w]:void 0;return(0,le.jsx)(le.Fragment,{children:(0,le.jsx)(U.OS,{ref:c,axis:"vertical",identifier:"run-gantt",firstInitialPercent:35,firstMinSize:56,first:function(e){return n?"QUEUED"===n.status?(0,le.jsx)(V.Fu,{run:n}):n.executionPlan&&E?(0,le.jsx)(P.S,{region:"gantt chart",children:(0,le.jsx)(V.hj,{options:{mode:V.hS.WATERFALL_TIMED},toolbarActions:(0,le.jsxs)(h.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[(0,le.jsx)(U.jo,{axis:"vertical",container:c}),(0,le.jsx)(at.NX,{run:n,onLaunch:u,graph:E,metadata:e,selection:{query:s,keys:k}})]}),runId:t,graph:E,metadata:e,selection:{query:s,keys:k},onClickStep:_,onSetSelection:l,focusedTime:r.focusedTime})}):(0,le.jsx)(j.t,{icon:"error",title:"Unable to build execution plan"}):(0,le.jsx)(V.ZW,{runId:t})}(i),second:(0,le.jsx)(P.S,{region:"logs",children:(0,le.jsxs)(gt,{children:[(0,le.jsx)(nt,{logType:S,onSetLogType:function(e){return v(et[e])},filter:r,onSetFilter:a,steps:T,metadata:i,computeLogFileKey:w,onSetComputeLogKey:function(e){C(e)},computeLogUrl:Z,counts:o.counts}),S!==et.structured?d?(0,le.jsx)(Ze,{logKey:w?[t,"compute_logs",w]:[],logCaptureInfo:O,visibleIOType:et[S],onSetDownloadUrl:R}):(0,le.jsx)(Je,{runId:t,stepKeys:T,computeLogFileKey:w,ioType:et[S],setComputeLogUrl:R}):(0,le.jsx)(fn.S,{logs:o,filter:r,filterStepKeys:D,filterKey:"".concat(JSON.stringify(r)),metadata:i})]})})})})},gt=O.ZP.div.withConfig({displayName:"Run__LogsContainer",componentId:"sc-1l2e0ac-0"})(["display:flex;flex-direction:column;height:100%;"]),ft=t(24138),ht=t(25465),mt=t(89622),vt=function(){(0,L.Px)();var e=(0,C.UO)().runId;(0,Z.j)(e?"Run ".concat(e.slice(0,8)):"Run");var n=(0,g.a)(wt,{variables:{runId:e}}),t=n.data,o=n.loading,r="Run"===(null===t||void 0===t?void 0:t.pipelineRunOrError.__typename)?t.pipelineRunOrError:null,i=null===r||void 0===r?void 0:r.pipelineSnapshotId,s=(0,k.n)(r),a=null!==s&&void 0!==s&&s.match?(0,E.kQ)(s.match.repository.name,s.match.repositoryLocation.name):null,l=b.useMemo((function(){return!!(r&&s&&(0,T.E8)(s.match,r.pipelineName))}),[r,s]);return(0,le.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,width:"100%",height:"100%",overflow:"hidden"},children:[(0,le.jsx)(h.x,{flex:{direction:"row",alignItems:"flex-start"},style:{position:"relative",zIndex:1},children:(0,le.jsx)(m.m,{title:(0,le.jsx)(v.X6,{style:{fontFamily:y.b.monospace,fontSize:"20px"},children:e.slice(0,8)}),tags:r?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ht.KG,{status:r.status}),(0,I.pv)(r.pipelineName)?(0,le.jsx)(D.m,{assetKeys:(0,mt.Bo)(r),useTags:!0}):(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)(x.V,{icon:"run",children:["Run of"," ",(0,le.jsx)(R.h,{pipelineName:null===r||void 0===r?void 0:r.pipelineName,pipelineHrefContext:a||"repo-unknown",snapshotId:i,size:"small",isJob:l})]}),(0,le.jsx)(D.m,{assetKeys:r.assets.map((function(e){return e.key})),useTags:!0})]}),(0,le.jsxs)(h.x,{flex:{direction:"row",alignItems:"flex-start",gap:12,wrap:"wrap"},children:[null!==r&&void 0!==r&&r.startTime?(0,le.jsx)(w.J,{interactionKind:"hover",placement:"bottom",content:(0,le.jsx)(h.x,{padding:16,children:(0,le.jsx)(ft.lc,{run:r,loading:o})}),children:(0,le.jsx)(x.V,{icon:"schedule",children:(0,le.jsx)(N.v,{timestamp:r.startTime,timeFormat:{showSeconds:!0,showTimezone:!1}})})}):r.updateTime?(0,le.jsx)(x.V,{icon:"schedule",children:(0,le.jsx)(N.v,{timestamp:r.updateTime,timeFormat:{showSeconds:!0,showTimezone:!1}})}):void 0,null!==r&&void 0!==r&&r.startTime&&null!==r&&void 0!==r&&r.endTime?(0,le.jsx)(w.J,{interactionKind:"hover",placement:"bottom",content:(0,le.jsx)(h.x,{padding:16,children:(0,le.jsx)(ft.lc,{run:r,loading:o})}),children:(0,le.jsx)(x.V,{icon:"timer",children:(0,le.jsx)("span",{style:{fontVariantNumeric:"tabular-nums"},children:null!==r&&void 0!==r&&r.startTime?(0,S.fv)((1e3*(null===r||void 0===r?void 0:r.endTime)||Date.now())-1e3*(null===r||void 0===r?void 0:r.startTime)):"\u2013"})})}):null]})]}):null,right:r?(0,le.jsx)(ft.Up,{run:r,isJob:l}):null})}),(0,le.jsx)(xt,{data:t,runId:e})]})},yt=vt,xt=function(e){var n=e.data,t=e.runId;return n&&n.pipelineRunOrError?"Run"!==n.pipelineRunOrError.__typename?(0,le.jsx)(h.x,{padding:{vertical:64},children:(0,le.jsx)(j.t,{icon:"error",title:"No run found",description:"The run with this ID does not exist or has been cleaned up."})}):(0,le.jsx)(ct,{run:n.pipelineRunOrError,runId:t}):(0,le.jsx)(ct,{run:void 0,runId:t})},wt=(0,f.Ps)(Xn||(Xn=(0,p.Z)(["\n  query RunRootQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        ...RunPageFragment\n      }\n    }\n  }\n\n  ","\n"])),en.tQ)},25960:function(e,n,t){t.d(n,{J:function(){return i},V:function(){return r}});var o=new Intl.NumberFormat(navigator.language,{compactDisplay:"short",notation:"compact"}),r=new Intl.NumberFormat(navigator.language,{}),i=function(e){return o.format(e)}}}]);
//# sourceMappingURL=399.d95f0c91.chunk.js.map