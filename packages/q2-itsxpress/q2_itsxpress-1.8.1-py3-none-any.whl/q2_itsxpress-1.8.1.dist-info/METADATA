Metadata-Version: 2.1
Name: q2-itsxpress
Version: 1.8.1
Summary: A QIIME2 plugin to trim ITS regions using ITSxpress
Author-email: "Adam R. Rivers" <adam.rivers@usda.gov>, "Sveinn V. Einarsson" <seinarsson@ufl.edu>
Maintainer-email: "Adam R. Rivers" <adam.rivers@usda.gov>, "Sveinn V. Einarsson" <seinarsson@ufl.edu>
License: Creative Commons Legal Code CC0 1.0 Universal Official translations of this
        legal tool are available CREATIVE COMMONS CORPORATION IS NOT A LAW FIRM AND DOES
        NOT PROVIDE LEGAL SERVICES. DISTRIBUTION OF THIS DOCUMENT DOES NOT CREATE AN
        ATTORNEY-CLIENT RELATIONSHIP. CREATIVE COMMONS PROVIDES THIS INFORMATION ON AN
        "AS-IS" BASIS. CREATIVE COMMONS MAKES NO WARRANTIES REGARDING THE USE OF THIS
        DOCUMENT OR THE INFORMATION OR WORKS PROVIDED HEREUNDER, AND DISCLAIMS LIABILITY
        FOR DAMAGES RESULTING FROM THE USE OF THIS DOCUMENT OR THE INFORMATION OR WORKS
        PROVIDED HEREUNDER. Statement of Purpose The laws of most jurisdictions
        throughout the world automatically confer exclusive Copyright and Related Rights
        (defined below) upon the creator and subsequent owner(s) (each and all, an
        "owner") of an original work of authorship and/or a database (each, a "Work").
        
        Certain owners wish to permanently relinquish those rights to a Work for the
        purpose of contributing to a commons of creative, cultural and scientific works
        ("Commons") that the public can reliably and without fear of later claims of
        infringement build upon, modify, incorporate in other works, reuse and
        redistribute as freely as possible in any form whatsoever and for any purposes,
        including without limitation commercial purposes. These owners may contribute to
        the Commons to promote the ideal of a free culture and the further production of
        creative, cultural and scientific works, or to gain reputation or greater
        distribution for their Work in part through the use and efforts of others.
        
        For these and/or other purposes and motivations, and without any expectation of
        additional consideration or compensation, the person associating CC0 with a Work
        (the "Affirmer"), to the extent that he or she is an owner of Copyright and
        Related Rights in the Work, voluntarily elects to apply CC0 to the Work and
        publicly distribute the Work under its terms, with knowledge of his or her
        Copyright and Related Rights in the Work and the meaning and intended legal
        effect of CC0 on those rights.
        
        1. Copyright and Related Rights. A Work made available under CC0 may be
        protected by copyright and related or neighboring rights ("Copyright and Related
        Rights"). Copyright and Related Rights include, but are not limited to, the
        following:
        
        the right to reproduce, adapt, distribute, perform, display, communicate, and
        translate a Work; moral rights retained by the original author(s) and/or
        performer(s); publicity and privacy rights pertaining to a person's image or
        likeness depicted in a Work; rights protecting against unfair competition in
        regards to a Work, subject to the limitations in paragraph 4(a), below; rights
        protecting the extraction, dissemination, use and reuse of data in a Work;
        database rights (such as those arising under Directive 96/9/EC of the European
        Parliament and of the Council of 11 March 1996 on the legal protection of
        databases, and under any national implementation thereof, including any amended
        or successor version of such directive); and other similar, equivalent or
        corresponding rights throughout the world based on applicable law or treaty, and
        any national implementations thereof. 2. Waiver. To the greatest extent
        permitted by, but not in contravention of, applicable law, Affirmer hereby
        overtly, fully, permanently, irrevocably and unconditionally waives, abandons,
        and surrenders all of Affirmer's Copyright and Related Rights and associated
        claims and causes of action, whether now known or unknown (including existing as
        well as future claims and causes of action), in the Work (i) in all territories
        worldwide, (ii) for the maximum duration provided by applicable law or treaty
        (including future time extensions), (iii) in any current or future medium and
        for any number of copies, and (iv) for any purpose whatsoever, including without
        limitation commercial, advertising or promotional purposes (the "Waiver").
        Affirmer makes the Waiver for the benefit of each member of the public at large
        and to the detriment of Affirmer's heirs and successors, fully intending that
        such Waiver shall not be subject to revocation, rescission, cancellation,
        termination, or any other legal or equitable action to disrupt the quiet
        enjoyment of the Work by the public as contemplated by Affirmer's express
        Statement of Purpose.
        
        3. Public License Fallback. Should any part of the Waiver for any reason be
        judged legally invalid or ineffective under applicable law, then the Waiver
        shall be preserved to the maximum extent permitted taking into account
        Affirmer's express Statement of Purpose. In addition, to the extent the Waiver
        is so judged Affirmer hereby grants to each affected person a royalty-free, non
        transferable, non sublicensable, non exclusive, irrevocable and unconditional
        license to exercise Affirmer's Copyright and Related Rights in the Work (i) in
        all territories worldwide, (ii) for the maximum duration provided by applicable
        law or treaty (including future time extensions), (iii) in any current or future
        medium and for any number of copies, and (iv) for any purpose whatsoever,
        including without limitation commercial, advertising or promotional purposes
        (the "License"). The License shall be deemed effective as of the date CC0 was
        applied by Affirmer to the Work. Should any part of the License for any reason
        be judged legally invalid or ineffective under applicable law, such partial
        invalidity or ineffectiveness shall not invalidate the remainder of the License,
        and in such case Affirmer hereby affirms that he or she will not (i) exercise
        any of his or her remaining Copyright and Related Rights in the Work or (ii)
        assert any associated claims and causes of action with respect to the Work, in
        either case contrary to Affirmer's express Statement of Purpose.
        
        4. Limitations and Disclaimers.
        
        No trademark or patent rights held by Affirmer are waived, abandoned,
        surrendered, licensed or otherwise affected by this document. Affirmer offers
        the Work as-is and makes no representations or warranties of any kind concerning
        the Work, express, implied, statutory or otherwise, including without limitation
        warranties of title, merchantability, fitness for a particular purpose, non
        infringement, or the absence of latent or other defects, accuracy, or the
        present or absence of errors, whether or not discoverable, all to the greatest
        extent permissible under applicable law. Affirmer disclaims responsibility for
        clearing rights of other persons that may apply to the Work or any use thereof,
        including without limitation any person's Copyright and Related Rights in the
        Work. Further, Affirmer disclaims responsibility for obtaining any necessary
        consents, permissions or other rights required for any use of the Work. Affirmer
        understands and acknowledges that Creative Commons is not a party to this
        document and has no duty or obligation with respect to this CC0 or use of the
        Work.
        
Project-URL: repository, http://github.com/usda-ars-gbru/q2_itsxpress
Keywords: Qiime2,plugin,Amplicon,sequencing,fungal,ITS
Classifier: Topic :: Scientific/Engineering :: Bio-Informatics
Classifier: Programming Language :: Python :: 3.8
Classifier: Development Status :: 7 - Inactive
Requires-Python: >=3.8
Description-Content-Type: text/x-rst
License-File: LICENSE.txt
Requires-Dist: qiime2
Requires-Dist: itsxpress (>=1.8.1)
Requires-Dist: pandas
Provides-Extra: tests
Requires-Dist: pytest ; extra == 'tests'

Q2_ITSxpress: A Qiime2 plugin to rapidly trim the Internally transcribed spacer (ITS) region of FASTQ files
===========================================================================================================

.. image:: https://github.com/USDA-ARS-GBRU/q2_itsxpress/actions/workflows/python-package.yml/badge.svg
   :target: https://github.com/USDA-ARS-GBRU/q2_itsxpress/actions/workflows/python-package.yml
   :alt: Build Status
   
.. image:: https://img.shields.io/github/v/release/USDA-ARS-GBRU/q2_itsxpress?style=social
   :target: https://github.com/USDA-ARS-GBRU/q2_itsxpress/releases/latest
   :alt: GitHub release (latest by date)
   
.. image:: https://zenodo.org/badge/138209572.svg
   :target: https://zenodo.org/badge/latestdoi/138209572



#####

This is the end of life version 1 of q2_itsxpress and the command line version of ITSxpress. See 
1.8.1-EOL branch of ITSxpress. The new version 2 of ITSxpress, has the Qiime2 plugin built in with command line version of ITSxpress.

#####

See ITSxpress 1.8.1-EOL branch here: ITSxpress-1.8.1-EOL_

.. _`ITSxpress-1.8.1-EOL`: https://github.com/USDA-ARS-GBRU/itsxpress/tree/1.8.1-EOL


Authors
-------
* Adam R. Rivers, US Department of Agriculture, Agricultural Research Service
* Kyle C. Weber, US Department of Agriculture, Agricultural Research Service
* Sveinn V. Einarsson, US Department of Agriculture, Agricultural Research Service

Citation
--------
Rivers AR, Weber KC, Gardner TG et al. ITSxpress: Software to rapidly trim
internally transcribed spacer sequences with quality scores for marker gene
analysis. F1000Research 2018, 7:1418. doi: `10.12688/f1000research.15704.1`_

.. _`10.12688/f1000research.15704.1`: https://doi.org/10.12688/f1000research.15704.1

Introduction
------------

The internally transcribed spacer (ITS) is a region between the small subunit
and large subunit rRNA genes. In is a commonly used phylogenetic marker for
Fungi and other Eukaryotes. The ITS contains the 5.8s gene and two variable
length spacer regions. In amplicon sequencing studies it is common practice to
trim off the conserved (SSU, 5,8S or LSU) regions. Bengtsson-Palme et al. (2013)
published a software package ITSx_ to do this.

Q2-ITSxpress extends this work by rapidly trimming FASTQ sequences within
Qiime2.  Q2-ITSxpress is the Qiime2 plugin version of the stand alone command
line utility ITSxpress_. Q2_ITSxpress is designed to support the calling of
exact sequence variants rather than OTUs. This newer method of sequence
error-correction requires quality score data from each sequence, so each input
sequence must be trimmed. ITSxpress makes this possible by taking FASTQ data,
de-replicating the sequences then identifying the start and stop sites using
HMMSearch. Results are parsed and the trimmed files are returned. The ITS1,
ITS2 or the entire ITS region including the 5.8s rRNA gene can be selected.
ITSxpress uses the hmm models from ITSx so results are nearly identical.


Requirements/Dependencies
-------------------------

* Qiime2 is required to run Q2-itsxpress (for stand alone software see ITSxpress_)
* To install Qiime2 follow these instructions: https://docs.qiime2.org/2022.8/install/
* This end of life version 1 of q2-itsxpress and ITSxpress is **ONLY** compatible with Qiime2 version 2022.8. So make sure to follow the link above.

* We are using mamba because it resolves packages better and faster, but conda can be substituted.
	- Information on installing mamba or micromamba (either highly recommended) can be found here: `mamba installation guide`_

.. _`mamba installation guide`: https://mamba.readthedocs.io/en/latest/installation.html

Q2-itsxpress plugin installation
--------------------------------
1. Example on how to install and create new Qiime2-2022.8 environment.

.. code-block:: bash

  wget https://data.qiime2.org/distro/core/qiime2-2022.8-py38-osx-conda.yml
  mamba env create -n qiime2-2022.8 --file qiime2-2022.8-py38-osx-conda.yml

2. Activate the Qiime2 conda environment

.. code-block:: bash

  mamba activate qiime2-2022.8

3. Install Q2_itsxpress using BioConda_. Be sure to install itsxpress and q2_itsxpress in the Qiime2 environment using the following commands.

.. code-block:: bash

  mamba install -c bioconda itsxpress==1.8.1
  pip install q2-itsxpress

4. In your Qiime2 environment, refresh the plugins.

.. code-block:: bash

  qiime dev refresh-cache

5. Check to see if the ITSxpress plugin is installed. You should see an output similar to the image below.

.. code-block:: bash

  qiime itsxpress

.. image:: ./screenshot.png

Usage
-----

Within Qiime2 you can trim paired-end or single-end reads using these commands

.. code-block:: bash

  qiime itsxpress trim-pair

  qiime itsxpress trim-pair-output-unmerged

  qiime itsxpress trim-single

1. qiime itsxpress trim-single

  This command takes single-end data and returns trimmed reads. The sequence may
  have been merged previously or have been generated from a long read technology
  like PacBio. Merged and long reads trimmed by this function can be used by
  Deblur but only long reads (not merged reads) trimmed by this function should
  be passed to Dada2. Its statistical model for estimating error rates was not
  designed for pre-merged reads.

+----------------------------------+---------------------------------------------------------------------------------------+
|    Command-requirement           | Description                                                                           |
+----------------------------------+---------------------------------------------------------------------------------------+
|   --i-per-sample-sequences       | - The artifact that contains the sequence file(s).                                    |
+ 			           + - Either Joined Paired or just a single fastq.                                        +
|                                  | - One file sequence in the qza data folder.                                           |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --p-region                 | - The regions ITS2, ITS1, and ALL.                                                    |
+----------------------------------+---------------------------------------------------------------------------------------+
|				   | -	Select the taxonomic group sequenced: A, B, C, D, E, F, G, H, I, L, M, O, P,	   |
+	--p-taxa		   +	Q, R, S, T, U, V, ALL.								   +
| 				   |											   |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --p-threads 	           | - The amount of threads to use.                                                       |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --o-trimmed                | - The resulting trimmed sequences from ITSxpress in a qza format.                     |
+----------------------------------+---------------------------------------------------------------------------------------+
|      --cluster-id                | - The percent identity for clustering reads, set to 1 for exact dereplication.        |
+----------------------------------+---------------------------------------------------------------------------------------+


2. qiime itsxpress trim-pair

  This command takes paired-end data and returns merged, trimmed reads. The
  merged reads trimmed by this function can be used by Deblur but not
  Dada2. Its statistical model for estimating error rates was not
  designed for pre-merged reads, instead use `qiime itsxpress trim-pair-output-unmerged`.

+----------------------------------+---------------------------------------------------------------------------------------+
|    Command-requirement           | Description                                                                           |
+----------------------------------+---------------------------------------------------------------------------------------+
|   --i-per-sample-sequences       | - The artifact that contains the sequence file(s).                                    |
+ 			           + - Either Joined Paired or just a single fastq.                                        +
|                                  | - One file sequence in the qza data folder.                                           |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --p-region                 | - The regions ITS2, ITS1, and ALL.                                                    |
+----------------------------------+---------------------------------------------------------------------------------------+
|				   | -	Select the taxonomic group sequenced: A, B, C, D, E, F, G, H, I, L, M, O, P,	   |
+	--p-taxa		   +	Q, R, S, T, U, V, ALL.								   +
| 				   |											   |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --p-threads 	           | - The amount of threads to use.                                                       |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --o-trimmed                | - The resulting trimmed sequences from ITSxpress in a qza format.                     |
+----------------------------------+---------------------------------------------------------------------------------------+
|      --cluster-id                | - The percent identity for clustering reads, set to 1 for exact dereplication.        |
+----------------------------------+---------------------------------------------------------------------------------------+

3. qiime itsxpress trim-pair-output-unmerged

  This command takes paired-end data and returns unmerged, trimmed reads. The
  merged reads trimmed by this function can be used by Dada2 but not Deblur.
  For Deblur use `qiime itsxpress trim-pair`.

+----------------------------------+---------------------------------------------------------------------------------------+
|    Command-requirement           | Description                                                                           |
+----------------------------------+---------------------------------------------------------------------------------------+
|   --i-per-sample-sequences       | - The artifact that contains the sequence file.                                       |
+ 			           + - Only paired will work.                                                              +
|                                  | - Two file sequences in the qza data folder.                                          |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --p-region                 | - The regions ITS2, ITS1, and ALL.                                                    |
+----------------------------------+---------------------------------------------------------------------------------------+
|				   | -	Select the taxonomic group sequenced: A, B, C, D, E, F, G, H, I, L, M, O, P,	   |
+	--p-taxa		   +	Q, R, S, T, U, V, ALL.								   +
| 				   |											   |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --p-threads 	           | - The amount of threads to use.                                                       |
+----------------------------------+---------------------------------------------------------------------------------------+
|       --o-trimmed                | - The resulting trimmed sequences from ITSxpress in a qza format.                     |
+----------------------------------+---------------------------------------------------------------------------------------+
|      --cluster-id                | - The percent identity for clustering reads, set to 1 for exact dereplication.        |
+----------------------------------+---------------------------------------------------------------------------------------+

Taxa Key
--------

+-+-------------------------------------+
|A| Alveolata				|
+-+-------------------------------------+
|B| Bryophyta				|
+-+-------------------------------------+
|C| Bacillariophyta			|
+-+-------------------------------------+
|D| Amoebozoa				|
+-+-------------------------------------+
|E| Euglenozoa				|
+-+-------------------------------------+
|F| Fungi				|
+-+-------------------------------------+
|G| Chlorophyta (green algae)		|
+-+-------------------------------------+
|H| Rhodophyta (red algae)		|
+-+-------------------------------------+
|I| Phaeophyceae (brown algae)		|
+-+-------------------------------------+
|L| Marchantiophyta (liverworts)	|
+-+-------------------------------------+
|M| Metazoa				|
+-+-------------------------------------+
|O| Oomycota				|
+-+-------------------------------------+
|P| Haptophyceae (prymnesiophytes)	|
+-+-------------------------------------+
|Q| Raphidophyceae			|
+-+-------------------------------------+
|R| Rhizaria				|
+-+-------------------------------------+
|S| Synurophyceae			|
+-+-------------------------------------+
|T| Tracheophyta (higher plants)	|
+-+-------------------------------------+
|U| Eustigmatophyceae			|
+-+-+-----------------------------------+
|ALL| All				|
+---+-----------------------------------+



Example
-------

Use case: Trimming the ITS2 region from a fungal amplicon
sequencing dataset with a PairedSequencesWithQuailty qza using two cpu threads.
The example file used is in the Tests folder under paired.qza.

.. code:: bash

  qiime itsxpress trim-pair --i-per-sample-sequences ~/parired.qza --p-region ITS2 \
  --p-taxa F --p-threads 2 --o-trimmed ~/Desktop/out.qza

License information
-------------------

This software is a work of the United States Department of Agriculture,
Agricultural Research Service and is released under a Creative Commons CC0
public domain attribution.

.. _ITSxpress: https://github.com/USDA-ARS-GBRU/itsxpress
.. _ITSx: http://microbiology.se/software/itsx/
.. _BioConda: https://bioconda.github.io/
